import{ah as ce,r as l,ao as e,ar as a,ay as L,av as x,at as ie,aB as J,ax as g,az as h,au as pe,aq as me,ak as u,am as j,an as n}from"./index-CFiG4jUx.js";import{F as o}from"./index-C-rmEvZ_.js";import{S as y,R as E}from"./index-BXFIHTMJ.js";import{R as b}from"./useBreakpoint-BeMf8Kwx.js";import{a as $,F as G}from"./Table-BajktlNK.js";import{R as A}from"./AppstoreOutlined-DL08C6ad.js";import{I as M}from"./index-BIFbDk8c.js";const{TextArea:K}=M,{Text:c,Paragraph:B}=me,{TabPane:H}=J,be=()=>{const{t}=ce(),[N,Q]=l.useState([]),[f,U]=l.useState([]),[W,D]=l.useState(!1),[_,v]=l.useState(!1),[w,R]=l.useState(null),[i,O]=l.useState(null),[X,V]=l.useState(!1),[Y,C]=l.useState(!1),[I,q]=l.useState(null),[p,Z]=l.useState(null),[m]=o.useForm(),[d]=o.useForm(),T=()=>{Q(u.getAll())},S=()=>{U(j.getAll())};l.useEffect(()=>{T(),S()},[]);const k=s=>{R(s||null),D(!0),s?m.setFieldsValue({name:s.name,content:s.content}):m.resetFields()},z=()=>{D(!1),R(null),m.resetFields()},ee=async s=>{try{w?(u.update(w.id,s),n.success(t("prompts.promptUpdateSuccess"))):(u.create(s),n.success(t("prompts.promptCreateSuccess"))),T(),z()}catch(r){console.error("保存提示词失败:",r),n.error(t("prompts.saveFailed"))}},te=s=>{try{u.delete(s),n.success(t("prompts.promptDeleteSuccess")),T()}catch(r){console.error("删除提示词失败:",r),n.error(t("prompts.deleteFailed"))}},se=s=>{O(s),v(!0)},P=s=>{q(s||null),V(!0),s?d.setFieldsValue({name:s.name,content:s.content,category:s.category}):d.resetFields()},F=()=>{V(!1),q(null),d.resetFields()},re=async s=>{try{I?(j.update(I.id,s),n.success(t("prompts.templateUpdateSuccess"))):(j.create(s),n.success(t("prompts.templateCreateSuccess"))),S(),F()}catch(r){console.error("保存测试模板失败:",r),n.error(t("prompts.saveFailed"))}},ae=s=>{try{j.delete(s),n.success(t("prompts.templateDeleteSuccess")),S()}catch(r){console.error("删除测试模板失败:",r),n.error(t("prompts.deleteFailed"))}},le=s=>{Z(s),C(!0)},oe=[{title:t("prompts.name"),dataIndex:"name",key:"name",width:200},{title:t("prompts.contentPreview"),dataIndex:"content",key:"content",render:s=>e.jsx("div",{className:"text-ellipsis-2",style:{maxHeight:"48px"},children:s})},{title:t("prompts.createdAt"),dataIndex:"createdAt",key:"createdAt",width:180,render:s=>new Date(s).toLocaleString("zh-CN")},{title:t("prompts.updatedAt"),dataIndex:"updatedAt",key:"updatedAt",width:180,render:s=>new Date(s).toLocaleString("zh-CN")},{title:t("prompts.actions"),key:"action",width:200,render:(s,r)=>e.jsxs(y,{size:"small",children:[e.jsx(a,{type:"default",size:"small",icon:e.jsx(b,{}),onClick:()=>se(r),className:"border-blue-300 text-blue-600 hover:bg-blue-50",children:t("prompts.view")}),e.jsx(a,{type:"default",size:"small",icon:e.jsx(L,{}),onClick:()=>k(r),className:"border-green-300 text-green-600 hover:bg-green-50",children:t("prompts.edit")}),e.jsx($,{title:t("prompts.confirmDeletePrompt"),onConfirm:()=>te(r.id),okText:t("prompts.confirmText"),cancelText:t("prompts.cancelText"),children:e.jsx(a,{type:"default",size:"small",danger:!0,icon:e.jsx(E,{}),className:"border-red-300 text-red-600 hover:bg-red-50",children:t("prompts.delete")})})]})}],ne=[{title:t("prompts.name"),dataIndex:"name",key:"name",width:200},{title:t("prompts.category"),dataIndex:"category",key:"category",width:120,render:s=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:s})},{title:t("prompts.contentPreview"),dataIndex:"content",key:"content",render:s=>e.jsx("div",{className:"text-ellipsis-2",style:{maxHeight:"48px"},children:s})},{title:t("prompts.createdAt"),dataIndex:"createdAt",key:"createdAt",width:180,render:s=>new Date(s).toLocaleString("zh-CN")},{title:t("prompts.actions"),key:"action",width:200,render:(s,r)=>e.jsxs(y,{size:"small",children:[e.jsx(a,{type:"default",size:"small",icon:e.jsx(b,{}),onClick:()=>le(r),className:"border-blue-300 text-blue-600 hover:bg-blue-50",children:t("prompts.view")}),e.jsx(a,{type:"default",size:"small",icon:e.jsx(L,{}),onClick:()=>P(r),className:"border-green-300 text-green-600 hover:bg-green-50",children:t("prompts.edit")}),e.jsx($,{title:t("prompts.confirmDeleteTemplate"),onConfirm:()=>ae(r.id),okText:t("prompts.confirmText"),cancelText:t("prompts.cancelText"),children:e.jsx(a,{type:"default",size:"small",danger:!0,icon:e.jsx(E,{}),className:"border-red-300 text-red-600 hover:bg-red-50",children:t("prompts.delete")})})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:e.jsx(x,{className:"text-white text-xl"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t("prompts.title")}),e.jsx("p",{className:"text-gray-500 mt-1",children:t("prompts.subtitle")})]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:N.length+f.length}),e.jsx("div",{className:"text-sm text-gray-500",children:t("prompts.totalTemplates")})]})})]})}),e.jsx(ie,{className:"shadow-sm border-gray-200",children:e.jsxs(J,{defaultActiveKey:"prompts",size:"large",children:[e.jsxs(H,{tab:e.jsxs("span",{children:[e.jsx(x,{}),t("prompts.promptTemplates")," (",N.length,")"]}),children:[e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsx(a,{type:"primary",icon:e.jsx(g,{}),onClick:()=>k(),size:"large",className:"bg-gradient-to-r from-purple-500 to-pink-500 border-none shadow-lg hover:shadow-xl",children:t("prompts.addPrompt")})}),e.jsx(G,{columns:oe,dataSource:N,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(s,r)=>t("common.pagination",{start:r[0],end:r[1],total:s})},className:"custom-table",locale:{emptyText:e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(x,{className:"text-4xl text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:t("prompts.noPrompts")}),e.jsx(a,{type:"primary",icon:e.jsx(g,{}),onClick:()=>k(),className:"bg-gradient-to-r from-purple-500 to-pink-500 border-none",children:t("prompts.createFirstPrompt")})]})}})]},"prompts"),e.jsxs(H,{tab:e.jsxs("span",{children:[e.jsx(A,{}),t("prompts.testInputTemplates")," (",f.length,")"]}),children:[e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsx(a,{type:"primary",icon:e.jsx(g,{}),onClick:()=>P(),size:"large",className:"bg-gradient-to-r from-blue-500 to-indigo-500 border-none shadow-lg hover:shadow-xl",children:t("prompts.addTestTemplate")})}),e.jsx(G,{columns:ne,dataSource:f,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(s,r)=>t("common.pagination",{start:r[0],end:r[1],total:s})},className:"custom-table",locale:{emptyText:e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(A,{className:"text-4xl text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:t("prompts.noTestTemplates")}),e.jsx(a,{type:"primary",icon:e.jsx(g,{}),onClick:()=>P(),className:"bg-gradient-to-r from-blue-500 to-indigo-500 border-none",children:t("prompts.createFirstTemplate")})]})}})]},"inputs")]})}),e.jsx(h,{title:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(x,{className:"text-purple-500"}),e.jsx("span",{children:t(w?"prompts.editPrompt":"prompts.addPrompt")})]}),open:W,onCancel:z,footer:null,width:800,children:e.jsxs(o,{form:m,layout:"vertical",onFinish:ee,children:[e.jsx(o.Item,{label:t("prompts.promptName"),name:"name",rules:[{required:!0,message:t("prompts.nameRequired")},{max:100,message:t("prompts.nameMaxLength")}],children:e.jsx(M,{placeholder:t("prompts.promptNamePlaceholder"),size:"large"})}),e.jsx(o.Item,{label:t("prompts.promptContent"),name:"content",rules:[{required:!0,message:t("prompts.contentRequired")},{max:5e3,message:t("prompts.contentMaxLength")}],children:e.jsx(K,{rows:12,placeholder:t("prompts.promptContentPlaceholder"),showCount:!0,maxLength:5e3})}),e.jsx(o.Item,{className:"mb-0",children:e.jsxs(y,{children:[e.jsx(a,{type:"primary",htmlType:"submit",size:"large",className:"bg-gradient-to-r from-purple-500 to-pink-500 border-none",children:t("prompts.save")}),e.jsx(a,{onClick:z,size:"large",children:t("prompts.cancel")})]})})]})}),e.jsx(h,{title:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{className:"text-blue-500"}),e.jsx("span",{children:t(I?"prompts.editTestTemplate":"prompts.addTestTemplate")})]}),open:X,onCancel:F,footer:null,width:800,children:e.jsxs(o,{form:d,layout:"vertical",onFinish:re,children:[e.jsx(o.Item,{label:t("prompts.templateName"),name:"name",rules:[{required:!0,message:t("prompts.templateNameRequired")},{max:100,message:t("prompts.nameMaxLength")}],children:e.jsx(M,{placeholder:t("prompts.templateNamePlaceholder"),size:"large"})}),e.jsx(o.Item,{label:t("prompts.category"),name:"category",rules:[{required:!0,message:t("prompts.categoryRequired")}],children:e.jsx(pe,{placeholder:t("prompts.categoryPlaceholder"),size:"large",mode:"tags",maxTagCount:1,options:[{label:t("prompts.categories.textGeneration"),value:t("prompts.categories.textGeneration")},{label:t("prompts.categories.codeGeneration"),value:t("prompts.categories.codeGeneration")},{label:t("prompts.categories.translation"),value:t("prompts.categories.translation")},{label:t("prompts.categories.qa"),value:t("prompts.categories.qa")},{label:t("prompts.categories.creativeWriting"),value:t("prompts.categories.creativeWriting")},{label:t("prompts.categories.analysis"),value:t("prompts.categories.analysis")},{label:t("prompts.categories.other"),value:t("prompts.categories.other")}]})}),e.jsx(o.Item,{label:t("prompts.testContent"),name:"content",rules:[{required:!0,message:t("prompts.testContentRequired")},{max:2e3,message:t("prompts.testContentMaxLength")}],children:e.jsx(K,{rows:8,placeholder:t("prompts.testContentPlaceholder"),showCount:!0,maxLength:2e3})}),e.jsx(o.Item,{className:"mb-0",children:e.jsxs(y,{children:[e.jsx(a,{type:"primary",htmlType:"submit",size:"large",className:"bg-gradient-to-r from-blue-500 to-indigo-500 border-none",children:t("prompts.save")}),e.jsx(a,{onClick:F,size:"large",children:t("prompts.cancel")})]})})]})}),e.jsx(h,{title:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"text-blue-500"}),e.jsx("span",{children:t("prompts.promptDetails")})]}),open:_,onCancel:()=>v(!1),footer:[e.jsx(a,{onClick:()=>v(!1),size:"large",children:t("prompts.close")},"close")],width:800,children:i&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs(c,{strong:!0,className:"text-gray-700",children:[t("prompts.name"),":"]}),e.jsx(c,{className:"ml-2 text-lg",children:i.name})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs(c,{strong:!0,className:"text-gray-700",children:[t("prompts.content"),":"]}),e.jsx(B,{className:"mt-3 p-4 bg-white rounded border whitespace-pre-wrap shadow-sm",children:i.content})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs(c,{strong:!0,className:"text-gray-700",children:[t("prompts.createdAt"),":"]}),e.jsx("div",{className:"mt-1 text-sm text-gray-600",children:new Date(i.createdAt).toLocaleString("zh-CN")})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs(c,{strong:!0,className:"text-gray-700",children:[t("prompts.updatedAt"),":"]}),e.jsx("div",{className:"mt-1 text-sm text-gray-600",children:new Date(i.updatedAt).toLocaleString("zh-CN")})]})]})]})}),e.jsx(h,{title:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"text-blue-500"}),e.jsx("span",{children:t("prompts.testTemplateDetails")})]}),open:Y,onCancel:()=>C(!1),footer:[e.jsx(a,{onClick:()=>C(!1),size:"large",children:t("prompts.close")},"close")],width:800,children:p&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs(c,{strong:!0,className:"text-gray-700",children:[t("prompts.name"),":"]}),e.jsx(c,{className:"ml-2 text-lg",children:p.name})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs(c,{strong:!0,className:"text-gray-700",children:[t("prompts.content"),":"]}),e.jsx(B,{className:"mt-3 p-4 bg-white rounded border whitespace-pre-wrap shadow-sm",children:p.content})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs(c,{strong:!0,className:"text-gray-700",children:[t("prompts.category"),":"]}),e.jsx("div",{className:"mt-1 text-sm text-gray-600",children:p.category})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs(c,{strong:!0,className:"text-gray-700",children:[t("prompts.createdAt"),":"]}),e.jsx("div",{className:"mt-1 text-sm text-gray-600",children:new Date(p.createdAt).toLocaleString("zh-CN")})]})]})]})})]})};export{be as default};
